<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>Ethereum Development Environment and Tools</title>
		<style>
			body {
	font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
h1, h2, h3 {
	font-weight: 400;
	margin-bottom: 0;
}
.remark-slide-content h1 { font-size: 3em; }
.remark-slide-content h2 { font-size: 2em; }
.remark-slide-content h3 { font-size: 1.6em; }
.footnote {
	position: absolute;
	bottom: 3em;
}
li p { line-height: 1.25em; }
.red { color: #fa0000; }
.large { font-size: 2em; }
a, a > code {
	color: rgb(249, 38, 114);
	text-decoration: none;
}
code {
	background: none repeat scroll 0 0 #F8F8FF;
  border: 1px solid #DEDEDE;
  border-radius: 3px 	;
  padding: 0 0.2em;
}
.remark-code, .remark-inline-code { font-family: "Bitstream Vera Sans Mono", "Courier", monospace; }
.remark-code-line-highlighted     { background-color: #373832; }
.pull-left {
	float: left;
	width: 47%;
}
.pull-right {
	float: right;
	width: 47%;
}
.pull-right ~ p {
	clear: both;
}
#slideshow .slide .content code {
	font-size: 0.8em;
}
#slideshow .slide .content pre code {
	font-size: 0.9em;
	padding: 15px;
}
.main-title, .title {
	background: #272822;
	color: #777872;
	text-shadow: 0 0 20px #333;
}
.title h1, .title h2, .main-title h1, .main-title h2 {
	color: #f3f3f3;
	line-height: 0.8em;
}
/* Custom */
.remark-code {
	display: block;
	padding: 0.5em;
}

		</style>
	</head>
	<body>
		<textarea id="source">
class: center, middle

# Ethereum Development Environment and Tools

---
## Ethereum and Smart Contract

- General purpose blockchain

- Ethereum: TCP/IP = Bitcoin: SMTP

- Smart contract: logic + data at a specific address

---
## Ethereum accounts

- External accounts: controlled by public-private key pairs (i.e. humans)
    - ether

- Contract accounts: controlled by the code stored together with the account.
    - ether
    - code (logic)
    - data (storage)

- EVM treats the two types equally

---
## Simple contract: OneValueContract
```Javascript
contract OneValue {
    uint256 value;

    function OneValue(uint256 initValue) {
        value = initValue;
    }

    function setValue(uint256 v) {
        value = v;
    }

    function getValue() constant returns (uint256 result){
        return value;
    }
}
```
---
## All in one wallet: Mist
- The Mist browser is the tool of choice to browse and use Ãapps (decentralized applications).

- Github: https://github.com/ethereum/mist

- Installable binaries: https://github.com/ethereum/mist/releases

---

## Mist demo

- Network: mainnet and testnet

- Mining: testnet only (can still enable it via console)

- Wallets

- Send

- Contracts


---

## Mist / Ethereum data location

- Mist:
    - Windows:  `%APPDATA%\Mist`

    - Mac:  `~/Library/Application Support/Mist`

    - Linux: `~/.config/Mist`

- Ethereum:

    - Mac:  `~/Library/Ethereum`

---
## Geth

- Ethereum go implementation (Mist is actually using geth)
    - `ps -aef | grep geth`

- Install:
    - https://www.ethereum.org/cli

- Management API:
    - https://github.com/ethereum/go-ethereum/wiki/Management-APIs

- Javascript Console:
    - https://github.com/ethereum/go-ethereum/wiki/JavaScript-Console

- Attach to Mist geth console:
    - `geth attach ipc:~/Library/Ethereum/geth.ipc`

---

## Run geth (mainnet)

```bash
geth --fast  \
    --datadir "~/.eth/mainnet"  \
    --rpc --rpccorsdomain "*"  \
    --ipcapi "admin,db,eth,debug,miner,net,shh,txpool,personal,web3"  \
    --rpcapi "db,eth,net,web3,personal"  \
    --rpcport "8547"  \
    --port "30305" \
    --support-dao-fork \
    console
```

---

## Run geth (testnet)

```bash
geth --fast \
    --datadir "~/.eth/testnet"  \
    --ipcapi "admin,db,eth,debug,miner,net,shh,txpool,personal,web3"  \
    --rpc --rpccorsdomain "*"  \
    --rpcapi "db,eth,net,web3,personal"  \
    --rpcport "8546" \
    --port "30304" \
    --testnet \
    console
```

---
## Solidity compiler: solc

- solcjs

```bash
npm install solc -g
```

- solc: https://github.com/ethereum/solidity

```bash
git clone --recursive https://github.com/ethereum/solidity.git
cd solidity
mkdir build
cd build
cmake .. && make && make install
```

---

## Solidity editor

- Atom: language-ethereum

- SublimeText: ethereum

- Visual Studio: Solidity

- Remix (formerly Mix) IDE https://github.com/ethereum/remix

---

## Compile contract

- Browser-Solidity: https://ethereum.github.io/browser-solidity/

- Mist: Contacts tab -> deploy new contract # This can deploy contract directly

- solc

    ```
    solc --abi --bin -o ./build one-value.sol
    ```

---
## Libraries and development tools

- Web3: https://github.com/ethereum/web3.js

    This is the Ethereum compatible [JavaScript API](https://github.com/ethereum/wiki/wiki/JavaScript-API) which implements the [Generic JSON RPC](https://github.com/ethereum/wiki/wiki/JSON-RPC) spec.

- Testrpc: https://github.com/ethereumjs/testrpc

    Fast Ethereum RPC client for testing and development. (RPC mock)


- Truffle: https://github.com/ConsenSys/truffle

    Truffle is a development environment, testing framework and asset pipeline for Ethereum, aiming to make life as an Ethereum developer easier.

---
## Web3

- Install:

    `npm install web3`

- Enable rpc in console:

    `admin.startRPC("0.0.0.0", "8545", "","db,eth,net,web3,personal")`

- Example code: `node web3-test.js`

    ```Javascript
    var Web3 = require('web3');
    var web3 = new Web3(
        new Web3.providers.HttpProvider("http://localhost:8545"));

    web3.eth.getBlock(48, function(error, result){
        if(!error)
            console.log(result)
        else
            console.error(error);
    });
    ```

---
## Testrpc

- Install:

    `npm install -g ethereumjs-testrpc`


- Run testrpc:

    `testrpc -p 8547`

- Connect with Web3: `node web3-testrpc.js`

    ```Javascript
    var Web3 = require('web3');
    var TestRPC = require("ethereumjs-testrpc");
    var web3 = new Web3(TestRPC.provider());
    web3.eth.getAccounts(function(e, accts){
        console.log("error:", e);
        console.log("accounts:", accts);
        process.exit(0);
    });
    ```

---
## Truffle

- Install:
    `npm install -g truffle`

- Init:
    `truffle init`

- Compile:
    `truffle compile`

-  Deploy:
    `truffle migrate`

- Build frontend:
    `truffle build`

- Run frontend:
    `truffle serve`

- Edit `truffle.js` to config rpc.

- Open dapp:
    `open http://localhost:8080`


---
## Deploy contract with Mist

### Contracts -> Deploy new contract -> Paste code and deploy

---
## Deploy contract with Truffle

- Update rpc setting in `truffle.js`

- Create contract: `truffle create:contract OneValue`

- Edit `OneValue.sol`

- Build: `truffle build`

- Add migration file: `3_deploy_one_value_contract.js`

- Deploy: `truffle migrate`

---
## Deploy contract with Web3

- Deploy to testrpc: `node deploy-contract-testrpc.js`

- Deploy to testnet: `node deploy-contract-test.js`

- Example code (partial):

    ```Javascript
    var abi  = ...
    var evmCode = ...
    var OneValueContract = web3.eth.contract(abi);
    var oneValue = OneValueContract.new(initValue,
        {from:addr, data: evmCode, gas: 4700000},
        function(error, contract){
            ...
        }
    );
    ```

---
## Mining

- In console:

    ```
    miner.start(1)
    ```

- In geth command:

    ```
    geth --mine --minerthread "4"
    ```

- In mist: (testnet only)

    - Develop -> Start Mining


---
## Interact with contract (Express + Web3)

- Example (partial):

```Javascript
var abi  = ... var OneValueContract = web3.eth.contract(abi);
var contractAddress = '0x36274a6286c9cf3c8e09c85c5bfa572a8827fddc'; //Testnet
var oneValue = OneValueContract.at(contractAddress);

app.get('/', function (req, res) {
  res.send(
      'OneValue Instance: ' + contractAddress + "\n" +
      'Value: '+ oneValue.getValue() + "\n");
});

app.listen(3000)
```

- Run: `node express-example.js`

- Test: `curl http://localhost:3000`

		</textarea>
		<script src="https://amisamity.github.io/contract-training/slides/js/remark-latest.min.js"></script>
		<script>
			var slideshow = remark.create();
		</script>
		<script></script>
	</body>
</html>
